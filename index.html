<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SustainML Interface</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background-color: #4A4A4A;
            color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .sidebar h2 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .sidebar p {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
        }


        .main-container {
            width: calc(100% - 250px); /* Prend en compte la sidebar */
            max-width: 1400px;
            margin-left: 250px;
            position: relative;
        }

        /* Superior Grid */
        .superior-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px; /* Adjust spacing */
            padding: 20px;
            background-color: #dfe7ec; /* Light blueish-gray background */
            border-radius: 12px; /* Soft rounded corners */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow effect */
            margin: 20px auto; /* Center it */
            width: 90%; /* Responsive width */
        }

        .data-source {
            width: 250px; /* Adjusted width */
            height: 180px; /* Match Data Selection */
            background-color: #ccc;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .data-source h3 {
            font-size: 20px;
            color: #333;
            margin-bottom: 15px;
        }

        .drag-drop-search {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .drag-drop {
            font-size: 16px;
            color: #333;
            text-decoration: underline;
            cursor: pointer;
        }

        .drag-drop:hover {
            color: #007BFF;
        }

        .drag-drop-search label,
        .drag-drop-search span,
        .search-bar {
            display: block;
            margin-top: 5px;
        }

        .data-selection {
            width: 400px; /* Increased width */
            height: 180px; /* Keep the same height */
            background-color: #e5edf2;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }


        .hidden {
            display: none;
        }

        /* Table Wrapper */
        .table-wrapper {
            max-height: 140px;
            overflow: auto;
        }

        /* Arrow Styling */
        .arrow {
            margin: 0 10px;
        }

        .submit-section {
            display: flex;
            align-items: center;
        }

        #submit-btn {
            background-color: gray;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: not-allowed;
        }

        .table-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 600px;
            height: auto;
            overflow: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
        }

        thead {
            background-color: #d4dce2;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 2;
        }

        th, td {
            padding: 10px;
            border: 1px solid #aaa;
        }


        .table-container::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background-color: #aaa;
            border-radius: 10px;
        }

        /*  Responsive Fix */
        @media (max-width: 768px) {
            .table-container {
                max-width: 100%;
            }
        }

        .search-bar {
            display: flex;
            align-items: center;
            border: 1px solid #ccc;
            border-radius: 4px;
            overflow: hidden;
            background-color: #f9f9f9;
        }

        .search-bar input {
            border: none;
            padding: 10px;
            font-size: 14px;
            outline: none;
            width: 200px;
            background-color: transparent;
        }

        .search-button {
            border: none;
            background-color: transparent;
            padding: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .search-button img {
            width: 20px;
            height: 20px;
            filter: invert(50%);
        }

        .search-button:hover img {
            filter: invert(30%) sepia(1) saturate(10) hue-rotate(200deg);
        }

        span {
            font-size: 16px;
            color: #666;
        }

        .arrow img {

            width: 70px; /* Larger arrow size */
            height: auto;
            display: block;
            margin: auto;
        }

        .arrow {
            position: relative;
            display: flex;
            justify-content: center;
            margin-top: 50px;
        }

        /* Data Selection Container */
        .data-selection {
            background-color: #e5edf2;
            border: 2px dashed #ccc;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
        }

        /* Title and Buttons (Select All & Deselect All) */
        .data-selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .data-selection.empty {
            opacity: 0.6;
            text-align: center;
            color: #aaa;
            font-style: italic;
        }

        .inferior-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-gap: 20px;
            padding: 20px;
        }

        /*  Section Geo Location & Hardware */
        .geo-hardware {
            background-color: #d6e8e8;
            border-radius: 12px;
            padding: 20px;
            box-shadow: none;
            position: relative;
        }

        /*  Section Goal & Optional */
        .goal-domain {
            background-color: #edd9e5; /* Couleur rose */
            border-radius: 12px;
            padding: 20px;
            box-shadow: none;
            position: relative;
        }


        /*  Geo Location & Hardware */
        .geo-list, .hardware-list {
            width: 45%;
            padding: 10px;
            background-color: #d0e8e0; /*  Change to a light greenish color */
            border-radius: 8px;
            padding: 15px;
            margin: 10px auto;

        }

        /*  Goal & Optional */
        .goal-list, .optional-list {
            width: 45%;
            padding: 10px;
            background-color: #f1d4e5; /*  Change to a light pinkish color */
            border-radius: 8px;
            padding: 15px;
            margin: 10px auto;

        }



        .geo-list { transform: translateX(-80px); }
        .hardware-list { transform: translateX(80px); }
        .goal-list { transform: translateX(-80px); }
        .optional-list { transform: translateX(80px); }


        .geo-hardware h3, .goal-domain h3 {
            text-align: center;  /* Center titles */
            margin-bottom: 10px; /* Adds space below */
            font-size: 18px;
            font-weight: bold;
        }

        .option {
            margin-bottom: 5px;
        }


        .option select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
            height: 28px;
        }


        @media (max-width: 768px) {
            .inferior-grid {
                grid-template-columns: 1fr;
            }


            .geo-list, .hardware-list, .goal-list, .optional-list {
                transform: none;
                width: 90%;
            }

            .geo-hardware h3,
            .hardware-availability h3,
            .goal-domain h3,
            .optional-section h3 {
                left: 0;

            }
        }

        .diagram-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }


        .circle {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            color: white;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            text-align: center;
            position: absolute;
        }


        .provide-data {
            background-color: #1f4b67;
            top: -200px;
            left: 50%;
            transform: translateX(-50%);
        }


        .describe-problem {
            background-color: #7c3a4f;
            right: -150px;
            bottom: -50px;
        }

        /* Cercle de l'environnement */
        .define-environment {
            background-color: #899955;
            left: -150px;
            bottom: -50px;
        }

        /* Select All & Deselect All Buttons */
        .table-controls button {
            background-color: #007BFF;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 5px;
        }

        .table-controls button:hover {
            background-color: #ddd;
        }

        /* Hide the buttons initially */
        .table-controls, .data-preparation {
            display: none;
        }


        button {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            background-color: #007bff;
            color: white;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Data Preparation Button */
        .data-preparation {
            text-align: center;
            margin-top: 15px;
        }

        .data-preparation button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
        }

        .data-preparation button:hover {
            background-color: #0056b3;
        }

        /* Hidden State */
        .hidden {
            display: none;
        }

        /* Result Box */
        .result-box {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            width: 350px;
        }

        .result-box h3 {
            text-align: center;
            font-size: 18px;
        }

        .result-box p {
            font-size: 14px;
            margin: 5px 0;
        }

        .result-box button {
            display: block;
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .result-box button:hover {
            background-color: #0056b3;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        /* Tooltip Container */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-right: 5px; /* Small spacing to avoid overlap */
        }

        /* Tooltip Text */
        .tooltip .tooltip-text {
            visibility: hidden;
            background-color: rgba(51, 51, 51, 0.9);
            color: #fff;
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            position: absolute;
            bottom: 130%; /* Position tooltip above label */
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.2s ease-in-out;
            font-size: 12px;
            z-index: 1000;
            max-width: 200px; /* Prevents large tooltips */
        }

        /* Show Tooltip on Hover */
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(-5px);
        }

        /* Keep List Styling the Same */
        .option {
            margin-bottom: 10px;
        }

        .option select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            background-color: #f9f9f9;
            height: 35px; /* Keeps the select boxes consistent */
        }
        .logo {
            width: 120px; /* Adjust as needed */
            height: auto;
            display: block;
            margin: 0 auto 20px; /* Centers logo & adds spacing */
        }

        .logo-container {
            text-align: center;
            margin-top: 20px;
        }

        .logo-container img {
            width: 150px; /* Adjust size */
            height: auto;
        }


    </style>
</head>
<body>

    <div class="main-container">

        <div class="sidebar">
            <img src="logo.png" alt="SustainML Logo" class="logo">
            <h2>About the System</h2>
            <p>Hover over a section to see details.</p>
        </div>

        <!-- Superior Grid -->
        <div class="superior-grid">
            <!-- Data Source (Smaller & Aligned) -->
            <div class="data-source">
                <h3>Data Source</h3>
                <div class="drag-drop-search">
                    <label for="file-input" class="drag-drop">Drag and drop</label>
                    <br> <!-- New Line -->
                    <span>or</span>
                    <br> <!-- New Line -->
                    <div class="search-bar">
                        <input type="text" placeholder="Search Huggingface" id="search-bar">
                        <button class="search-button">
                            <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png" alt="Search Icon">
                        </button>
                    </div>
                </div>
                <input type="file" id="file-input" hidden>
            </div>

            <!-- First Arrow (Between Data Source & Data Selection) -->
            <div class="arrow">
                <img src="arrow.png" alt="Arrow">
            </div>

            <!-- Data Selection (Smaller Width, Same Height as Data Source) -->
            <div class="data-selection" id="data-selection">
                <h3>Data Selection</h3>
                <p id="no-data-text">No data selected yet.</p> <!-- Hide when data is uploaded -->
                <div class="table-wrapper">
                    <div class="table-container">
                        <table id="data-table">
                            <thead>
                                <tr id="table-header"></tr> <!-- Dynamic headers inserted here -->
                            </thead>
                            <tbody id="table-body"></tbody> <!-- Dynamic rows inserted here -->
                        </table>
                    </div>
                </div>
            </div>

            <!-- Second Arrow (Between Data Selection & Submit) -->
            <div class="arrow">
                <img src="arrow.png" alt="Arrow">
            </div>

            <!-- Submit Button (Initially Disabled) -->
            <div class="submit-section">
                <button id="submit-btn" disabled>Submit</button>
            </div>

            <div id="refresh-results" class="hidden">
                <button class="results-button">Refresh Results</button>
            </div>

            <select id="refresh-results-specific" class="hidden">
                <option value="">Refresh node...</option>
                <option value="ALL">ALL</option>
                <option value="APP_REQUIREMENTS">APP_REQUIREMENTS</option>
                <option value="CARBON_FOOTPRINT">CARBON_FOOTPRINT</option>
                <option value="HW_CONSTRAINTS">HW_CONSTRAINTS</option>
                <option value="HW_RESOURCES">HW_RESOURCES</option>
                <option value="ML_MODEL_METADATA">ML_MODEL_METADATA</option>
                <option value="ML_MODEL">ML_MODEL</option>
                <option value="ORCHESTRATOR">ORCHESTRATOR</option>
            </select>

            <select id="request-datas">
                <option value="">Request for...</option>
                <option value="Modalities">Modalities</option>
                <option value="Problems_from_modality">Problems_from_modality</option>
                <option value="Model_info">Model_info</option>
                <option value="Input_output_modalities">Input_output_modalities</option>
                <option value="Metrics_from_modalities">Metrics_from_modalities</option>
                <option value="Metrics_from_problem">Metrics_from_problem</option>
                <option value="All_metrics">All_metrics</option>
                <option value="Hardwares">Hardwares</option>
            </select>

            <div id="framework-results" class="hidden">
                <!-- JSON data will be displayed here -->
            </div>

            <div id="resulted-model" class="result-box hidden">
                <h3>Resulted Model</h3>
                <p><strong>Model Name:</strong> <span id="model-name">-</span></p>
                <p><strong>Task:</strong> <span id="model-task">-</span></p>
                <p><strong>Problem Definition:</strong> <span id="model-problem">-</span></p>
                <p><strong>Hardware:</strong> <span id="model-hardware">-</span></p>
                <p><strong>Programming Language:</strong> <span id="model-language">-</span></p>
                <button id="download-model">Download Model</button>
            </div>

            <div id="node-status" class="hidden">
                <!-- JSON data will be displayed here -->
            </div>

        </div>



        <div class="diagram-container">
            <div class="diagram">
                <div class="circle provide-data">Provide Data <br> 0kg</div>
                <div class="circle describe-problem">Describe Problem <br> 0kg</div>
                <div class="circle define-environment">Define Environment <br> 0kg</div>

            </div>
        </div>

        <div class="inferior-grid">
            <!--  Geo Location et Hardware Availability -->
            <div class="geo-hardware grid-item" id="geo-location">
                <!-- Geo Location -->
                <h3>Geo Location</h3>
                <div class="geo-list">
                    <div class="option">
                        <label>Your location</label>
                        <select id="country-select">
                            <option value="">Select a country</option>
                            <option value="Afghanistan">Afghanistan</option>
                            <option value="Albania">Albania</option>
                            <option value="Algeria">Algeria</option>
                            <option value="Andorra">Andorra</option>
                            <option value="Angola">Angola</option>
                            <option value="Antigua and Barbuda">Antigua and Barbuda</option>
                            <option value="Argentina">Argentina</option>
                            <option value="Armenia">Armenia</option>
                            <option value="Australia">Australia</option>
                            <option value="Austria">Austria</option>
                            <option value="Azerbaijan">Azerbaijan</option>
                            <option value="Bahamas">Bahamas</option>
                            <option value="Bahrain">Bahrain</option>
                            <option value="Bangladesh">Bangladesh</option>
                            <option value="Barbados">Barbados</option>
                            <option value="Belarus">Belarus</option>
                            <option value="Belgium">Belgium</option>
                            <option value="Belize">Belize</option>
                            <option value="Benin">Benin</option>
                            <option value="Bhutan">Bhutan</option>
                            <option value="Bolivia">Bolivia</option>
                            <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
                            <option value="Botswana">Botswana</option>
                            <option value="Brazil">Brazil</option>
                            <option value="Brunei">Brunei</option>
                            <option value="Bulgaria">Bulgaria</option>
                            <option value="Burkina Faso">Burkina Faso</option>
                            <option value="Burundi">Burundi</option>
                            <option value="Cabo Verde">Cabo Verde</option>
                            <option value="Cambodia">Cambodia</option>
                            <option value="Cameroon">Cameroon</option>
                            <option value="Canada">Canada</option>
                            <option value="Central African Republic">Central African Republic</option>
                            <option value="Chad">Chad</option>
                            <option value="Chile">Chile</option>
                            <option value="China">China</option>
                            <option value="Colombia">Colombia</option>
                            <option value="Comoros">Comoros</option>
                            <option value="Congo (Congo-Brazzaville)">Congo (Congo-Brazzaville)</option>
                            <option value="Costa Rica">Costa Rica</option>
                            <option value="Croatia">Croatia</option>
                            <option value="Cuba">Cuba</option>
                            <option value="Cyprus">Cyprus</option>
                            <option value="Czech Republic">Czech Republic</option>
                            <option value="Democratic Republic of the Congo">Democratic Republic of the Congo</option>
                            <option value="Denmark">Denmark</option>
                            <option value="Djibouti">Djibouti</option>
                            <option value="Dominica">Dominica</option>
                            <option value="Dominican Republic">Dominican Republic</option>
                            <option value="Ecuador">Ecuador</option>
                            <option value="Egypt">Egypt</option>
                            <option value="El Salvador">El Salvador</option>
                            <option value="Equatorial Guinea">Equatorial Guinea</option>
                            <option value="Eritrea">Eritrea</option>
                            <option value="Estonia">Estonia</option>
                            <option value="Eswatini">Eswatini</option>
                            <option value="Ethiopia">Ethiopia</option>
                            <option value="Fiji">Fiji</option>
                            <option value="Finland">Finland</option>
                            <option value="France">France</option>
                            <option value="Gabon">Gabon</option>
                            <option value="Gambia">Gambia</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Germany">Germany</option>
                            <option value="Ghana">Ghana</option>
                            <option value="Greece">Greece</option>
                            <option value="Grenada">Grenada</option>
                            <option value="Guatemala">Guatemala</option>
                            <option value="Guinea">Guinea</option>
                            <option value="Guinea-Bissau">Guinea-Bissau</option>
                            <option value="Guyana">Guyana</option>
                            <option value="Haiti">Haiti</option>
                            <option value="Honduras">Honduras</option>
                            <option value="Hungary">Hungary</option>
                            <option value="Iceland">Iceland</option>
                            <option value="India">India</option>
                            <option value="Indonesia">Indonesia</option>
                            <option value="Iran">Iran</option>
                            <option value="Iraq">Iraq</option>
                            <option value="Ireland">Ireland</option>
                            <option value="Israel">Israel</option>
                            <option value="Italy">Italy</option>
                            <option value="Jamaica">Jamaica</option>
                            <option value="Japan">Japan</option>
                            <option value="Jordan">Jordan</option>
                            <option value="Kazakhstan">Kazakhstan</option>
                            <option value="Kenya">Kenya</option>
                            <option value="Kuwait">Kuwait</option>
                            <option value="Kyrgyzstan">Kyrgyzstan</option>
                            <option value="Laos">Laos</option>
                            <option value="Latvia">Latvia</option>
                            <option value="Lebanon">Lebanon</option>
                            <option value="Lesotho">Lesotho</option>
                            <option value="Liberia">Liberia</option>
                            <option value="Libya">Libya</option>
                            <option value="Lithuania">Lithuania</option>
                            <option value="Luxembourg">Luxembourg</option>
                            <option value="Madagascar">Madagascar</option>
                            <option value="Malawi">Malawi</option>
                            <option value="Malaysia">Malaysia</option>
                            <option value="Maldives">Maldives</option>
                            <option value="Mali">Mali</option>
                            <option value="Malta">Malta</option>
                            <option value="Mexico">Mexico</option>
                            <option value="Moldova">Moldova</option>
                            <option value="Monaco">Monaco</option>
                            <option value="Mongolia">Mongolia</option>
                            <option value="Montenegro">Montenegro</option>
                            <option value="Morocco">Morocco</option>
                            <option value="Mozambique">Mozambique</option>
                            <option value="Myanmar">Myanmar</option>
                            <option value="Namibia">Namibia</option>
                            <option value="Nepal">Nepal</option>
                            <option value="Netherlands">Netherlands</option>
                            <option value="New Zealand">New Zealand</option>
                            <option value="Nicaragua">Nicaragua</option>
                            <option value="Nigeria">Nigeria</option>
                            <option value="North Korea">North Korea</option>
                            <option value="Norway">Norway</option>
                            <option value="Pakistan">Pakistan</option>
                            <option value="Palestine">Palestine</option>
                            <option value="Panama">Panama</option>
                            <option value="Peru">Peru</option>
                            <option value="Philippines">Philippines</option>
                            <option value="Poland">Poland</option>
                            <option value="Portugal">Portugal</option>
                            <option value="Qatar">Qatar</option>
                            <option value="Romania">Romania</option>
                            <option value="Russia">Russia</option>
                            <option value="Saudi Arabia">Saudi Arabia</option>
                            <option value="South Africa">South Africa</option>
                            <option value="Spain">Spain</option>
                            <option value="United States">United States</option>
                            <option value="United Kingdom">United Kingdom</option>
                            <option value="Vietnam">Vietnam</option>
                            <option value="Zimbabwe">Zimbabwe</option>
                        </select>
                    </div>
                    <div class="option">
                        <label>Is the environment cloud-based or local</label>
                        <select>
                            <option>Local</option>
                            <option>Cloud</option>
                        </select>
                    </div>
                    <div class="option">
                        <label>Are you open for using cloud-based service</label>
                        <select>
                            <option>Yes</option>
                            <option>No</option>
                        </select>
                    </div>
                </div>

                <!-- Hardware Availability -->
                <div class="geo-hardware grid-item" id="hardware">
                    <h3>Hardware Availability</h3>
                    <div class="hardware-list">
                        <div class="option">
                            <label>Hardware</label>
                            <select>
                                <option>GPU</option>
                                <option>CPU</option>
                                <option>TPU</option>
                            </select>
                        </div>
                        <div class="option">
                            <label>Memory and storage capacity</label>
                            <select>
                                <option>I know</option>
                                <option>I don't know</option>
                            </select>
                        </div>
                        <div class="option">
                            <label>Are there any limitations on runtime or resources</label>
                            <select>
                                <option>Yes</option>
                                <option>No</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!--  Goal and Domain -->
            <div class="goal-domain grid-item" id="goal-domain">
                <h3>Goal and Domain</h3>
                <div class="goal-list">
                    <div class="option">
                        <label>Data Modality</label>
                        <select>
                            <option>Image/Video</option>
                            <option>Text</option>
                            <option>Sensor</option>
                        </select>
                    </div>
                    <div class="option">
                        <div class="tooltip">
                            <label for="task-select">Task:</label>
                            <span class="tooltip-text">Choose the primary task you want to perform</span>
                        </div>
                        <select id="task-select">
                            <option value="">Select a Task</option>
                        </select>
                    </div>
                    <div class="option">
                        <div class="tooltip">
                            <label for="problem-select">Problem Definition:</label>
                            <span class="tooltip-text">Select the specific problem related to the task</span>
                        </div>
                        <select id="problem-select">
                            <option value="">Select a Problem Definition</option>
                        </select>
                    </div>
                </div>



                <div class="goal-domain grid-item" id="optional">
                    <h3>Optional</h3>
                    <div class="optional-list">
                        <div class="option">
                            <label>Domain</label>
                            <select>
                                <option>Health</option>
                                <option>Agriculture</option>
                                <option>Economics</option>
                            </select>
                        </div>
                        <div class="option">
                            <div class="tooltip">
                                <label for="library-select">Libraries:</label>
                                <span class="tooltip-text">Select a framework or library to use</span>
                            </div>
                            <select id="library-select">
                                <option value="">Loading libraries...</option>
                            </select>
                        </div>
                        <div class="option">
                            <label>Programming Language</label>
                            <select>
                                <option>Python</option>
                                <option>R</option>
                                <option>Java</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>


        </div>


    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            console.log(" Page Loaded");

            const dropArea = document.querySelector(".drag-drop");
            const fileInput = document.getElementById("file-input");
            const submitButton = document.getElementById("submit-btn");
            const resultContainer = document.getElementById("resulted-model");

            let fileUploaded = false;


            const taskCategories = {
                "Multimodal": ["Audio-Text-to-Text", "Image-Text-to-Text", "Visual Question Answering"],
                "Computer Vision": ["Image Classification", "Object Detection", "Image Segmentation"],
                "Natural Language Processing": ["Text Classification", "Translation", "Text Generation"],
                "Audio": ["Text-to-Speech", "Automatic Speech Recognition"],
                "Tabular": ["Tabular Classification", "Time Series Forecasting"],
                "Reinforcement Learning": ["Reinforcement Learning", "Robotics"],
                "Other": ["Graph Machine Learning"]
            };

            const libraries = [
                "PyTorch", "TensorFlow", "JAX", "Transformers", "ONNX", "spaCy",
                "Scikit-learn", "speechbrain", "PaddlePaddle", "Fairseq"
            ];


            function populateTaskDropdown() {
                const taskSelect = document.getElementById("task-select");
                taskSelect.innerHTML = '<option value="">Select a Task</option>';

                Object.keys(taskCategories).forEach(category => {
                    let option = document.createElement("option");
                    option.value = category;
                    option.textContent = category;
                    taskSelect.appendChild(option);
                });

                taskSelect.addEventListener("change", function () {
                    populateProblemDropdown(taskSelect.value);
                    checkFormCompletion();
                });

                console.log(" Task dropdown populated!");
            }


            function populateProblemDropdown(selectedTask) {
                const problemSelect = document.getElementById("problem-select");
                problemSelect.innerHTML = '<option value="">Select a Problem Definition</option>';

                if (taskCategories[selectedTask]) {
                    taskCategories[selectedTask].forEach(problem => {
                        let option = document.createElement("option");
                        option.value = problem;
                        option.textContent = problem;
                        problemSelect.appendChild(option);
                    });
                }

                problemSelect.addEventListener("change", checkFormCompletion);
            }


            function populateLibraryDropdown() {
                const librarySelect = document.getElementById("library-select");
                librarySelect.innerHTML = '<option value="">Select a Library</option>';

                libraries.forEach(library => {
                    let option = document.createElement("option");
                    option.value = library;
                    option.textContent = library;
                    librarySelect.appendChild(option);
                });

                librarySelect.addEventListener("change", checkFormCompletion);
                console.log(" Library dropdown populated!");
            }


            function handleFileUpload() {
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }

                function highlight() {
                    dropArea.style.color = "#007BFF";
                    dropArea.style.border = "2px dashed #007BFF";
                }

                function unhighlight() {
                    dropArea.style.color = "#333";
                    dropArea.style.border = "2px dashed #ccc";
                }

                function handleDrop(e) {
                    preventDefaults(e);
                    unhighlight();
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        fileInput.files = files;
                        processFile(files[0]);
                    }
                }

                function processFile(file) {
                    console.log("ðŸ“‚ File uploaded:", file.name);
                    fileUploaded = true;
                    document.getElementById("no-data-text").classList.add("hidden");

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        displayCSVData(e.target.result);
                    };
                    reader.readAsText(file);

                    checkFormCompletion();
                }

                dropArea.addEventListener("dragenter", highlight);
                dropArea.addEventListener("dragover", highlight);
                dropArea.addEventListener("dragleave", unhighlight);
                dropArea.addEventListener("drop", handleDrop);

                fileInput.addEventListener("change", function () {
                    if (fileInput.files.length > 0) {
                        processFile(fileInput.files[0]);
                    }
                });
            }


            function displayCSVData(csv) {
                const rows = csv.trim().split("\n").map(row => row.split(","));
                const tableHeader = document.getElementById("table-header");
                const tableBody = document.getElementById("table-body");

                tableHeader.innerHTML = "";
                tableBody.innerHTML = "";

                if (rows.length > 0) {
                    rows[0].forEach(header => {
                        let th = document.createElement("th");
                        th.textContent = header.trim();
                        tableHeader.appendChild(th);
                    });

                    rows.slice(1).forEach(row => {
                        let tr = document.createElement("tr");
                        row.forEach(cell => {
                            let td = document.createElement("td");
                            td.textContent = cell.trim();
                            tr.appendChild(td);
                        });
                        tableBody.appendChild(tr);
                    });

                    console.log(" CSV Data Displayed!");
                }
            }


            function checkFormCompletion() {
                const task = document.getElementById("task-select").value;
                const problem = document.getElementById("problem-select").value;
                const library = document.getElementById("library-select").value;

                if (task && problem && library) {                           // I commented this line to test the backend
                    // if (task && problem && library && fileUploaded) {    // For now fileUploaded should not be mandatory
                    submitButton.disabled = false;
                    submitButton.style.backgroundColor = "#007BFF";
                    submitButton.style.cursor = "pointer";
                } else {
                    submitButton.disabled = true;
                    submitButton.style.backgroundColor = "gray";
                    submitButton.style.cursor = "not-allowed";
                }
            }


            function fetchFilteredHuggingFaceModels(task, problem, library) {
                console.log("ðŸ” Fetching models for:", task, problem, library);

                const apiUrl = `https://huggingface.co/api/models?search=${problem}&limit=10`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(models => {
                        console.log(" Hugging Face Models Found:", models);

                        const filteredModels = models
                            .filter(model => model.tags && model.tags.includes(library))
                            .slice(0, 3)
                            .map(model => ({
                                name: model.id,
                                description: model.description || "No description available",
                                downloads: model.downloads || 0,
                                link: `https://huggingface.co/${model.id}`
                            }));

                        updateResultedModelUI(filteredModels);
                    })
                    .catch(error => console.error(" Error fetching Hugging Face models:", error));
            }


            function updateResultedModelUI(models) {
                resultContainer.innerHTML = `<h3>Recommended Models</h3>`;
                if (models.length === 0) {
                    resultContainer.innerHTML += `<p>No suitable models found. Try adjusting your filters.</p>`;
                    return;
                }

                models.forEach((model, index) => {
                    resultContainer.innerHTML += `
                        <div class="model-box">
                            <h4>Model ${index + 1}: <a href="${model.link}" target="_blank">${model.name}</a></h4>
                            <p><strong>Description:</strong> ${model.description}</p>
                            <p><strong>Downloads:</strong> ${model.downloads}</p>
                            <button onclick="window.open('${model.link}', '_blank')">Explore Model</button>
                        </div>
                    `;
                });
            }

            populateTaskDropdown();
            populateLibraryDropdown();
            handleFileUpload();

            submitButton.addEventListener("click", function () {            // I commented fetchFilteredHuggingFaceModels for backend tests to submit the user_input to the backend
                // fetchFilteredHuggingFaceModels(
                //    document.getElementById("task-select").value,
                //     document.getElementById("problem-select").value,
                //     document.getElementById("library-select").value
                // );

                console.log("Terminal/ PD send.");
                // PD use in backend to test connection
                const problem_short_description = "";
                const modality2 = "";
                const problem_definition = "";
                const ins = [""];
                const outs = [""];
                const min_value = 1;
                const max_value = 1;
                const optimize_carbon_footprint_auto = false;
                const optimize_carbon_footprint_manual = false;
                const previous_iteration = 0;
                const desired_carbon_footprint = 0.0;
                const geo_location_continent = "Europe";
                const geo_location_region = "Spain";
                const hardware_required = "";
                const max_memory_footprint = 0;
                const goal = "text-generation";
                const previous_problem_id = 0;
                const num_outputs = 2;

                // Handle the PD data submission (e.g., send it to your server) - Use the test version for the communication with the backend
                const pdDataTest = {
                    problem_short_description,
                    modality2,
                    problem_definition,
                    ins,
                    outs,
                    min_value,
                    max_value,
                    optimize_carbon_footprint_auto,
                    optimize_carbon_footprint_manual,
                    previous_iteration,
                    desired_carbon_footprint,
                    geo_location_continent,
                    geo_location_region,
                    hardware_required,
                    max_memory_footprint,
                    goal,
                    previous_problem_id,
                    num_outputs
                };

                console.log('PD Data:', pdDataTest);
                fetch('/send_pd', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "problem_short_description": problem_short_description,
                        "modality": modality2,
                        "problem_definition": problem_definition,
                        "inputs": ins,
                        "outputs": outs,
                        "minimum_samples": min_value,
                        "maximum_samples": max_value,
                        "optimize_carbon_footprint_auto": optimize_carbon_footprint_auto,
                        "optimize_carbon_footprint_manual": optimize_carbon_footprint_manual,
                        "previous_iteration": previous_iteration,
                        "desired_carbon_footprint": desired_carbon_footprint,
                        "geo_location_continent": geo_location_continent,
                        "geo_location_region": geo_location_region,
                        "extra_data": {
                            "hardware_required": hardware_required,
                            "max_memory_footprint": max_memory_footprint,
                            "goal": goal,
                            "previous_problem_id": previous_problem_id,
                            "num_outputs": num_outputs
                        }
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        // Show results
                        // document.getElementById("refresh-status").style.display = 'block';
                        document.getElementById("refresh-results").style.display = 'block';
                        document.getElementById("refresh-results-specific").style.display = 'block';
                        refreshStatusNode();
                        refreshResults();
                    })

                // // PD assume from the UI of this frontend
                // console.log("Terminal/ PD send.");
                // const geolocation = "";
                // const modality = "";
                // const cloud_based = "";
                // const open_for_cloud = "";
                // const hardware = "";
                // const memory_storage = "";
                // const limitations = "";
                // const data_modality = "";
                // const task = "";
                // const problem = "";
                // const domain = "";
                // const library = "";
                // const programming_language = "";
//
                // // Handle the PD data submission (e.g., send it to your server)
                // const pdData = {
                //     geolocation,
                //     modality,
                //     cloud_based,
                //     open_for_cloud,
                //     hardware,
                //     memory_storage,
                //     limitations,
                //     data_modality,
                //     task,
                //     problem,
                //     domain,
                //     library,
                //     programming_language
                // };
//
                // // TODO: Define variable send from tis frontend to eProsima backend for be able to support in backend
                // console.log('PD Data:', pdData);
                // fetch('/send_pd', {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({
                //         "geolocation": geolocation,
                //         "modality": modality,
                //         "cloud_based": cloud_based,
                //         "open_for_cloud": open_for_cloud,
                //         "hardware": hardware,
                //         "memory_storage": memory_storage,
                //         "limitations": limitations,
                //         "data_modality": data_modality,
                //         "task": task,
                //         "problem": problem,
                //         "domain": domain,
                //         "library": library,
                //         "programming_language": programming_language
                //     })
                // })
                //     .then(response => response.json())
                //     .then(data => {
                //         // Show results
                //         // document.getElementById("refresh-status").style.display = 'block';
                //         document.getElementById("refresh-results").style.display = 'block';
                //         document.getElementById("refresh-results-specific").style.display = 'block';
                //         refreshStatusNode();
                //         refreshResults();
                //     })
            });

            // <requestNodesState>
            // - Fetches the current status of all nodes in the system.
            // - Parameters: None
            function refreshStatusNode() {
                fetch('/get_status', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById("node-status").style.display = 'block';
                        document.querySelector('#node-status').innerHTML = JSON.stringify(data, null, 6)    // the json output is inside "data"
                            .replace(/\n/g, "<br>");                                                        // data can be put in a return to reuse the function
                        console.log('States:', data);
                        return data;
                        })
            }

            // <refreshResults>
            // - Fetches the output from the last iteration of all nodes in the system
            // - Parameters: None
            function refreshResults() {
                fetch('/get_results', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById("framework-results").style.display = 'block';
                        document.querySelector('#framework-results').innerHTML = JSON.stringify(data, null, 6)  // the json output is inside "data"
                            .replace(/\n/g, "<br>");                                                            // data can be put in a return to reuse the function
                        console.log('Results:', data);
                        return data;
                        })
            }

            document.getElementById('refresh-results').addEventListener('click', function () {
                refreshResults();
            });

            // <specificResults>
            // - Fetches the output from specific node in the system of a specific iteration
            // - Parameters: node, problem_id, iteration_id
            function specificResults(node, problem_id, iteration_id) {
                fetch('/get_results', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "node_id": node,                    // Possible node values [ALL, APP_REQUIREMENTS, CARBON_FOOTPRINT, HW_CONSTRAINTS, HW_RESOURCES, ML_MODEL_METADATA, ML_MODEL, ORCHESTRATOR]
                        "task_id": {                        //  ORCHESTRATOR gives the user_input
                            "problem_id": problem_id,
                            "iteration_id": iteration_id
                        }
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById("framework-results").style.display = 'block';
                        document.querySelector('#framework-results').innerHTML = JSON.stringify(data, null, 6)  // the json output is inside "data"
                            .replace(/\n/g, "<br>");                                                            // data can be put in a return to reuse the function
                        console.log('Results:', data);
                        return data;
                        })
            }

            document.getElementById('refresh-results-specific').addEventListener('change', function () {
                specificResults(this.value, 1, 1);      // Example of specific result (use node_name indicated previously, and problem_id and iteration_id ints bigger than 0)
            });

            document.getElementById('request-datas').addEventListener('change', function () {
                switch (this.value) {
                    case "Modalities":
                        refreshModalities();
                        break;
                    case "Problems_from_modality":
                        refreshProblemsFromModality("audio");               // Example of modality (one of the modalities received)
                        break;
                    case "Model_info":
                        refreshModelInfo("facebook/opt-125m");              // Example of model (one of the model received)
                        break;
                    case "Input_output_modalities":
                        refreshInputOutputModalities();
                        break;
                    case "Metrics_from_modalities":
                        refreshMetricsFromModalities("Image", "Label");     // Example of modalities (Input modality, Output modality)
                        break;
                    case "Metrics_from_problem":
                        refreshMetricsFromProblem("audio-text-to-text");    // Example of problem (one of the problem received)
                        break;
                    case "All_metrics":
                        refreshAllMetrics();
                        break;
                    case "Hardwares":
                        refreshHardwares();
                        break;
                    default:
                        console.log("Option not supported:", this.value);
                }
            });

            // <refreshModalities>
            // - Return all the possible modalities (cover_tags) supported by DFKI
            // - Parameters: None
            function refreshModalities() {
                fetch('/get_modality', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Modalities data:', data);      // the json output is inside "data"
                        return data;                                // data can be put in a return to reuse the function
                    })
            }

            // <refreshProblemsFromModality>
            // - Return all possible problems for a modality(cover_tag)
            // - Parameters: modality(cover_tag)
            function refreshProblemsFromModality(modality) {
                fetch('/get_problem_from_modality', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "modality": modality
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain problem types depending on the modality
                        console.log('Problem data:', data);                                         // the json output is inside "data"
                        return data;                                                                // data can be put in a return to reuse the function
                    })
            }

            // <refreshModelInfo>
            // - Return all information available from DFKI about a model
            // - Parameters: model_name
            function refreshModelInfo(model_name) {
                fetch('/get_model_info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "model": model_name
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain all info from a model
                        console.log('Model info:', data);                       // the json output is inside "data"
                        return data;                                            // data can be put in a return to reuse the function
                    })
            }

            // <refreshInputOutputModalities>
            // - Return all possible input and output modalities
            // - Parameters: None
            function refreshInputOutputModalities() {
                fetch('/get_inout_modalities', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Inputs & Output Modalities data:', data);  // the json output is inside "data"
                        return data;                                            // data can be put in a return to reuse the function
                    })
            }

            // <refreshMetricsFromModalities>
            // - Return all possible metrics related to the input and output modalities
            // - Parameters: input_modality, output_modality
            function refreshMetricsFromModalities(input_modality, output_modality) {
                fetch('/get_metrics_from_modalities', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "modalities": input_modality + ", " + output_modality
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Metrics data:', data);         // the json output is inside "data"
                        return data;                                // data can be put in a return to reuse the function

                    })
            }

            // <refreshMetricsFromProblem>
            // - Return all possible metrics related to a problem
            // - Parameters: problem
            function refreshMetricsFromProblem(problem) {
                fetch('/get_metrics_from_problem', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        "problem": problem
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Metrics data:', data);         // the json output is inside "data"
                        return data;                                // data can be put in a return to reuse the function
                    })
            }

            // <refreshAllMetrics>
            // - Return all possible metrics
            // - Parameters: None
            function refreshAllMetrics() {
                fetch('/get_all_metrics', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Metrics data:', data);         // the json output is inside "data"
                        return data;                                // data can be put in a return to reuse the function
                    })
            }

            // <refreshHardwares>
            // - Return all possible hardwares supported by upmem
            // - Parameters: None
            function refreshHardwares() {
                fetch('/get_hardware', { method: 'GET' })
                    .then(response => response.json())
                    .then(data => {
                        // Example to see how to obtain modalities
                        console.log('Hardware data:', data);        // the json output is inside "data"
                        return data;                                // data can be put in a return to reuse the function
                    })
            }

        });

    </script>
</body>
</html>
